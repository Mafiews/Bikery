<%= render "shared/navbar" %>

<div class="container">
  <div class="row justify-content-center">
    <h1>See available bikes around you</h1>
  </div>
  <div class="row justify-content-center">
    <%= link_to 'Back to homepage', root_path, class: "btn btn-success text-white" %>
  </div>

  <div class="row justify-content-center">
    <% @bikes.each do |bike| %>
      <div class="col-12 col-lg-4">
        <div class="card-product">
          <%= link_to bike_path(bike), class: 'card-link' do %>
            <%#= cl_image_tag bike.photo.key, height: 200, class: "card-img rounded" %>
          <% end %>
          <div class="card-product-infos">
            <h2><%= bike.model %></h2>
            <h5><i class="fas fa-bicycle"></i> <%= bike.bike_type %></h5>
            <h5><i class="fas fa-battery-full"></i> <%= bike.condition %></h5>
            <h5><i class="fas fa-euro-sign"></i> <%= bike.price %></h5>
          </div>
        </div>
      </div>
    <% end %>

    <div class="col-12 col-lg-8">
      <div id="map"
     style="width: 550px; height: 500px;"
     data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>"></div>

      <script>
        mapboxgl.accessToken = 'pk.eyJ1IjoibWFmaWV3cyIsImEiOiJja2RhYjJzaTQwdjV0MnlvZG93dHJjOG5yIn0.XnI3woDvnCIOrLjHD1PBnQ';
      var map = new mapboxgl.Map({
      container: 'map',
      style: 'mapbox://styles/mapbox/streets-v11',
      center: [2.353341, 48.856861],
      zoom: 12
      });

      map.addControl(
      new MapboxGeocoder({
      accessToken: mapboxgl.accessToken,
      mapboxgl: mapboxgl
      })
      );

      // Add zoom and rotation controls to the map.
      map.addControl(new mapboxgl.NavigationControl());
      </script>
    </div>
  </div>
</div>
